---
layout:     post   				    
title:      面试复习之数据库	
subtitle:   总结一些常见的数据库知识点
date:       2020/04/08		
author:     Honey 					
header-img: img/游戏上古卷轴原画4k高清壁纸_彼岸图网.jpg
catalog: true 						
tags:								
    - 数据库
    - 面试
---

## 事务的概念和特性

概念：事务（Transaction）是一个操作序列，不可分割的工作单位，以**BEGIN TRANSACTION**开始，以**ROLLBACK/COMMIT**结束

特性（ACID）：

- **原子性（Atomicity）**：逻辑上是不可分割的操作单元，事务的所有操作要么全部提交成功，要么全部失败回滚（用回滚日志实现，反向执行日志中的操作）；
- **一致性（Consistency）**：事务的执行必须使数据库保持一致性状态。在一致性状态下，所有事务对一个数据的读取结果都是相同的；
- **隔离性（Isolation）**：一个事务所做的修改在最终提交以前，对其它事务是不可见的（并发执行的事务之间不能相互影响）；
- **持久性（Durability）**：一旦事务提交成功，对数据的修改是永久性的

## 数据库的四种隔离级别

- **未提交读（Read Uncommited）**：在一个事务提交之前，它的执行结果对其它事务也是可见的。会导致脏读、不可重复读、幻读；
- **提交读（Read Commited）**：一个事务只能看见已经提交的事务所作的改变。可避免脏读问题；
- **可重复读（Repeatable Read）**：可以确保同一个事务在多次读取同样的数据时得到相同的结果。（MySQL的默认隔离级别）。可避免不可重复读；
- **可串行化（Serializable）**：强制事务串行执行，使之不可能相互冲突，从而解决幻读问题。可能导致大量的超时现象和锁竞争，实际很少使用。

---

- **脏读（Dirty Read）**：一个事务读取了被另一个事务修改、但未提交（进行了回滚）的数据，造成两个事务得到的数据不一致；
- **不可重复读（Nonrepeatable Read）**：在同一个事务中，某查询操作在一个时间读取某一行数据和之后一个时间读取该行数据，发现数据已经发生修改（可能被更新或删除了）；
- **幻读（Phantom Read）**：当同一查询多次执行时，由于其它事务在这个数据范围内执行了插入操作，会导致每次返回不同的结果集（和不可重复读的区别：针对的是一个数据整体/范围；并且需要是插入操作）

## 哪些情况下索引会失效

- 以“%(表示任意0个或多个字符)”开头的LIKE语句；
- OR语句前后没有同时使用索引；
- 数据类型出现隐式转化（如varchar不加单引号的话可能会自动转换为int型）；
- 对于多列索引，必须满足 最左匹配原则/最左前缀原则 (最左优先，eg：多列索引col1、col2和col3，则 索引生效的情形包括 col1或col1，col2或col1，col2，col3)；
- 如果MySQL估计全表扫描比索引快，则不使用索引（比如非常小的表）

## 未完待续
